<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2013 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Category view template
 *
 * @see Mage_Catalog_Block_Category_View
 */
?>
<style type="text/css">

    .banner-wrapper {
        background: none repeat scroll 0 0 #000000;
        float: left;
        height: 230px;
        overflow: hidden;
        position: relative;
        text-align: center;
        top: 0;
        width: 700px;
        z-index: 1;
    }

    .banner-wrapper {
        background: none repeat scroll 0 0 #000000;
        float: left;
        height: 230px;
        overflow: hidden;
        position: relative;
        text-align: center;
        top: 0;
        width: 700px;
        z-index: 1;
    }

    .homeBannerImageReelWindow {
        height: 230px;
        overflow: hidden;
        position: relative;
        width: 100%;
    }
    .homeBannerImageReel {
        float: left;
        position: relative;
        top: 0;
        width: 100%;
    }

    .homeBannerBox {
        float: left;
        height: 230px;
        width: 700px;
    }
    a {
        color: #848484;
        cursor: pointer;
        font-size: 14px;
        text-decoration: none;
    }
    img {
        border: 0 none;
        vertical-align: middle;
    }
</style>
<?php
    $_helper    = $this->helper('catalog/output');
    $_category  = $this->getCurrentCategory();
    $_imgHtml   = '';
//    if ($_imgUrl = $_category->getImageUrl()) {
//        $_imgHtml = '<p class="category-image"><img src="'.$_imgUrl.'" alt="'.$this->escapeHtml($_category->getName()).'" title="'.$this->escapeHtml($_category->getName()).'" /></p>';
//        $_imgHtml = $_helper->categoryAttribute($_category, $_imgHtml, 'image');
//    }
?>

<div class="page-title category-title">
    <?php if($this->IsRssCatalogEnable() && $this->IsTopCategory()): ?>
        <a href="<?php echo $this->getRssLink() ?>" class="link-rss"><?php echo $this->__('Subscribe to RSS Feed') ?></a>
    <?php endif; ?>
    <h1><?php echo $_helper->categoryAttribute($_category, $_category->getName(), 'name') ?></h1>
</div>
<div class="block">
    <?php
    echo $this->getLayout()->createBlock('cms/block')->setBlockId('detail_page_banner')->toHtml();
    ?>
</div>
<?php echo $this->getMessagesBlock()->getGroupedHtml() ?>

<?php if($_imgUrl): ?>
    <?php echo $_imgHtml ?>
<?php endif; ?>

<?php if($_description=$this->getCurrentCategory()->getDescription()): ?>
    <div class="category-description std">
        <?php echo $_helper->categoryAttribute($_category, $_description, 'description') ?>
    </div>
    <?php endif; ?>

<?php if($this->isContentMode()): ?>
    <?php echo $this->getCmsBlockHtml() ?>

<?php elseif($this->isMixedMode()): ?>
    <?php echo $this->getCmsBlockHtml() ?>
    <?php echo $this->getProductListHtml() ?>

<?php else: ?>
    <?php echo $this->getProductListHtml() ?>
<?php endif; ?>
<script>
    jQuery(document).ready(function() {
// begin banner ===================================================================================================

        if (jQuery("#homeBanner").size() > 0) {
            bannerCompleted=true;

            var i=jQuery("#homeBanner").css("width");
            i=i.replace('px','');
            var s=jQuery(".homeBannerBox").size();
            var o=i*s;
            var u=0;

            jQuery(".homeBannerImageReel").css({width:o});

            bannerRotate=function(){
                bannerCompleted=false;
                jQuery(".homeBannerNav li.homeBannerBtn").removeClass("homeBannerBtnActive");

                var e=u;
                var t=e*i;
                jQuery(".homeBannerNav li.homeBannerBtn").eq(u).addClass("homeBannerBtnActive");

                jQuery(".homeBannerImageReel").animate(
                    {left:-t},
                    500,
                    function(){bannerCompleted=true}
                )
            };

            jQuery(".homeBannerBtn").click(function(){
                if(bannerCompleted==true){
                    if(jQuery(this).index()>u){
                        var e=jQuery(this).index()-u;
                        u=u+e;
                        bannerRotate();
                    } else if(jQuery(this).index()<u){
                        var e=u-(jQuery(this).index());
                        u=u-e;
                        bannerRotate();
                    }
                };
                return false;
            });

            var chgSecond = 4000;  // change Second
            var slideSpeed = 1000; // speed
            function slidePhoto()
            {
                {
                    // when resize the window, compute the size again
                    i=jQuery("#homeBanner").css("width").replace('px','');
                    s=jQuery(".homeBannerBox").size();
                    o=i*s;
                    jQuery(".homeBannerImageReel").css({width:o});
                }

                u = u + 1;
                if (u == s) {
                    u = 0;
                }
                bannerRotate();
            }
            setInterval(slidePhoto,chgSecond);
        }
// end banner ===================================================================================================





    });
</script>