<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2013 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */

/**
 * Product view template
 *
 * @see Mage_Catalog_Block_Product_View
 * @see Mage_Review_Block_Product_View
 */
?>
<?php $_helper = $this->helper('catalog/output'); ?>
<?php $_product = $this->getProduct(); ?>
<script type="text/javascript">
    var optionsPrice = new Product.OptionsPrice(<?php echo $this->getJsonConfig() ?>);
</script>
<?php
$product_catena = $this->getAttrNameByOptionId("product_catena",$_product->getProductCatena());//篮球系列
$product_material = $this->getAttrNameByOptionId("product_material",$_product->getProductMaterial());//篮球材质;
$product_sku = $_product->getSku();//sku
$product_norm = $this->getAttrNameByOptionId("product_norm",$_product->getProductNorm());//篮球规格
$product_side = $this->getAttrNameByOptionId("product_side",$_product->getProductSide());//篮球场地
$size_table_id = $_product->getSizeTable();//尺码表valueid
$product_attributeSetName = $_product->getAttributeSetName();
//get description
$shortDescription =  $_product->getShortDescription();
if(strstr($shortDescription,"直径") && stristr($shortDescription,"mm")){
    if( strstr($shortDescription,'，')  ){
        $tmpArr = explode("，",$shortDescription);
        $shortDescription = "(".$tmpArr[1].")";
    }elseif(strstr($shortDescription,',')){
        $tmpArr = explode(",",$shortDescription);
        $shortDescription = "(". $tmpArr[1].")";
    }else{
        $shortDescription = '';
    }
}else{
    $shortDescription = '';
}

//get current category id
$layer = Mage::getSingleton('catalog/layer');
$_category = $layer->getCurrentCategory();
$currentCategoryId= $_category->getId();
if($currentCategoryId == 35):
//专属定制
?>
<!-- 定制背景 -->
<div class="bodyBg_cusMade">
    <img style="width:100%;" src="<?php echo $this->getSkinUrl('images/customMade/cBg2.jpg');  ?>" alt="">
</div>

<!-- 定制主框架 -->
<!-- 第一步 开始定制 -->
<div class="cusMadeCons madeStep_1" style="display:none;">
    <div class="cusMadeBox cusMadeCen">
        <div class="step_1_ball"><img src="<?php echo $this->getSkinUrl('images/customMade/step_1_ball.png');  ?>" alt=""></div>
        <div class="step_1_Btn"><a href="javascript:;"><img src="<?php echo $this->getSkinUrl('images/customMade/step_1_ballBtn.png');  ?>" alt=""></a></div>
    </div>
    <div class="cusMadeBox cusMadeRig">
        <div class="madeBoxVal">
            <h1>SPALDING 74-604 ID</h1>
            <h2>价格：￥220</h2>
        </div>

        <div class="madeBoxCons">
            <h3>可定制球皮</h3>
            <p>“掌控”系列的经典之作，销量之王，性价比之王，超强PU超耐磨，室内外通用，恰到好处的粘度让你轻松“掌控”比赛！</p>
            <dl class="prods">
                <dd>产品特点</dd>
                <dt>添加图案</dt>
                <dt>定制专属签名</dt>
            </dl>
            <div class="madeServ">斯伯丁定制退换货服务</div>
            <div class="madeDate">该产品定制将在4-6周内送货上门</div>
        </div>
        <div class="madeFuns">
            <button>开始定制</button>
        </div>
    </div>
</div>

<!-- 第二步  定制参数-->
<div class="cusMadeCons madeStep_2">
    <!-- 定制图案 -->
    <div class="madeStepImg">
        <img id="img_grip" style="position:absolute;opacity:0; z-index:100; cursor:pointer;" src="<?php echo $this->getSkinUrl('images/customMade/grip.png');  ?>" />
        <div class="cusMadeBox cusMadeCen">
            <div class="step_2_Fun" id="formBtn">
                <div class="step_2_FunBg"><img src="<?php echo $this->getSkinUrl('images/customMade/step_2_Bgball.png');  ?>" alt=""></div>
                <div class="step_2_funBtn">
                    <input type="file" onchange="previewImage(this,'avatar')" id="shopSetFile_1" name="file" style="display:none ">
                    <input type="button" onclick="shopSetFile_1.click();" class="step_2_funBtn_1">
                </div>

            </div>
            <div class="step_2_wrap" id="imgFuns" style="opacity:0; position:relative;">
                <div class="portrait_revolve">
                    <span>
                        <a href="javascript:;" class="revol_left_txt" onClick="avatarrotateleft();"><img src="<?php echo $this->getSkinUrl('images/customMade/rotLeft.png');  ?>" alt=""></a>
                    </span>
                    
                    <span>
                        <input type="file" onchange="previewImage(this,'avatar')" id="shopSetFile_2" name="file" style="display:none ">
                        <input type="button" onclick="shopSetFile_2.click();" value="重新添加" class="step_2_funBtn_2">
                    </span>

                    <span>
                        <a href="javascript:;" class="revol_right_txt" onClick="avatarrotateright();"><img src="<?php echo $this->getSkinUrl('images/customMade/rotRig.png');  ?>" alt=""></a>
                    </span>
                </div>
                <div class="funBall"><img src="<?php echo $this->getSkinUrl('images/customMade/step_2_funball.png');  ?>" alt=""></div>

                <div id="cut_div" style="width:400px; height:400px; border-radius:200px; overflow: hidden; position:absolute; cursor:pointer;">
                    <table style="border-collapse: collapse; z-index: 10; filter: alpha(opacity=75); position: relative; left: 0px; top: 0px; width: 400px;  height: 400px; opacity: 0.75; border-radius:200px; overflow:hidden;" cellspacing="0" cellpadding="0" border="0" unselectable="on">
                        <tr>
                            <td style="background: #000000; height: 97px;" colspan="3"></td>
                        </tr>
                        <tr>
                            <td style="background: #000000; width: 52px;"></td>
                            <td style="border: 1px dashed #ffffff; width: 296px; height: 186px;"></td>
                            <td style="background: #000000; width: 52px;"></td>
                        </tr>
                        <tr>
                            <td style="background: #000000; height: 117px;" colspan="3"></td>
                        </tr>
                    </table>
                    <img id="avatar" style="position:relative; top:-400px; left:0px"  src="<?php echo $this->getSkinUrl('images/customMade/source.jpg');  ?>" />
                </div>


                <div class="imgFuns">

                  <div style="position:absolute;">
                    <span><img style="margin-top: 5px; cursor:pointer;"  src="<?php echo $this->getSkinUrl('images/customMade/tomin.png');  ?>" alt="图片缩小" onclick="imageresize(false)" /></span>
                    <span><img id="img_track" style="width: 200px; height: 4px;" src="<?php echo $this->getSkinUrl('images/customMade/track.png');  ?>" /></span>
                    <span><img style="margin-top: 5px; cursor:pointer;" src="<?php echo $this->getSkinUrl('images/customMade/tomax.png');  ?>" alt="图片放大" onclick="imageresize(true)" /></span>
                  </div>
                   
                </div>
                        
            </div>
            
        </div>
    </div>
    <!-- 定制文本 -->
    <div class="madeStepTex" style="display:none;">
        <div class="cusMadeBox cusMadeCen">
            <div class="madeTex_ball"><img src="<?php echo $this->getSkinUrl('images/customMade/madeTexBg.png');  ?>" alt=""></div>
            <div class="madeTexWrap">
                spadling
            </div>
        </div>
    </div>

    <!-- 空白 -->
    <div class="madeStepNone" style="display:none;">
        <div class="cusMadeBox cusMadeCen">
            <div class="madeTex_ball"><img src="<?php echo $this->getSkinUrl('images/customMade/madeTexBg.png');  ?>" alt=""></div>
        </div>
    </div>
    <div class="cusMadeBox cusMadeRig">
        <div class="madeBoxVal">
            <h1>SPALDING 74-604 ID</h1>
            <h2>价格：￥220</h2>
        </div>
        <div class="madeP_btn madeP_1_btn madeP_btn_now">P1</div>
        <div class="madeP_btn madeP_2_btn">P2</div>
        
        <!-- p1 -->
        <div class="madeBoxCons madeBoxCons_p1">
            <h3>可定制球皮</h3>
            <p class="madeTs">选择添加图案或个性签名</p>
            <p class="madeSn">（每块定制球皮只可选择以下一种定制）</p>
            <!-- 定制参数 -->
            <dl class="madeBoxFuns">
                <dd class="madeKindTit madeKindTitImg madeNow">定制图案</dd>
                <dt class="madeKindCons madeKindImg">
                    <h5>***注意***</h5>
                    <p>支持jpg、gif、png格式，单张图片大小2M-8M</p>
                </dt>
                <dd class="madeKindTit madeKindTitTex">定制文字</dd>
                <dt class="madeKindCons madeKindTex">
                    <div class="madeTextInp">
                        <input type="text" class="madeTextInpBox" placeholder="请输入定制文字">
                    </div>
                    <p>请选择字号：</p>
                    <div id="product-options-wrapper" class="madeKindTexSpan">
                      <div class="sale-num">
                        <input type="radio" class="required-entry super-attribute-select" id="attribute2098" name="attribute2098" data-input="kinds" value="53">
                        <span class="sale_kind setSize_40" for="attribute2098" name="attribute2098">大号字体</span>
                        <input type="radio" class="required-entry super-attribute-select" id="attribute2097" name="attribute2097" data-input="kinds" value="54">
                        <span class="sale_kind setSize_30" for="attribute2097" name="attribute2097">中号字体</span>
                        <input type="radio" class="required-entry super-attribute-select" id="attribute2096" name="attribute2096" data-input="kinds" value="55">
                        <span class="sale_kind setSize_20" for="attribute2096" name="attribute2096">小号字体</span>
                      </div>
                    </div>
                </dt>
                <dd class="madeKindTit madeKindTitNon">空白</dd>
            </dl>
        </div>

        <!-- p2 -->
        <div class="madeBoxCons madeBoxCons_p2" style="display:none;">
            <h3>可定制球皮</h3>
            <p class="madeTs">选择添加图案或个性签名</p>
            <p class="madeSn">（每块定制球皮只可选择以下一种定制）</p>
            <!-- 定制参数 -->
            <dl class="madeBoxFuns">
                <dd class="madeKindTit madeKindTitImg madeNow">定制图案</dd>
                <dt class="madeKindCons madeKindImg">
                    <h5>***注意***</h5>
                    <p>支持jpg、gif、png格式，单张图片大小2M-8M</p>
                </dt>
                <dd class="madeKindTit madeKindTitTex">定制文字</dd>
                <dt class="madeKindCons madeKindTex">
                    <div class="madeTextInp">
                        <input type="text" class="madeTextInpBox" placeholder="请输入定制文字">
                    </div>
                    <div id="product-options-wrapper" class="madeKindTexSpan">
                      <div class="sale-num">
                        <input type="radio" class="required-entry super-attribute-select" id="attribute2098" name="attribute2098" data-input="kinds" value="53">
                        <span class="sale_kind setSize_40" for="attribute2098" name="attribute2098">大号字体</span>
                        <input type="radio" class="required-entry super-attribute-select" id="attribute2097" name="attribute2097" data-input="kinds" value="54">
                        <span class="sale_kind setSize_30" for="attribute2097" name="attribute2097">中号字体</span>
                        <input type="radio" class="required-entry super-attribute-select" id="attribute2096" name="attribute2096" data-input="kinds" value="55">
                        <span class="sale_kind setSize_20" for="attribute2096" name="attribute2096">小号字体</span>
                      </div>
                    </div>
                </dt>
                <dd class="madeKindTit madeKindTitNon">空白</dd>
            </dl>
            
        </div>

        <div class="madeSubmit">
            <button class="submitY">完成此次定制</button>
            <button class="submitN">重置此次定制</button>
        </div>
        <div class="madeFuns">
            <button>加入购物车</button>
        </div>
    </div>
</div>


<!-- 预览 -->
<!-- <div class="madeView"></div> -->


<div class="madeBotmSn">
    <h1>定制专属篮球</h1>
    <p>斯伯丁74-604“掌控”系列的经典之作，销量之王，性价比之王，超强PU超耐磨，室内外通用，<br>恰到好处的粘度让你轻松“掌控”比赛！</p>
</div>
<!-- 选择字号 -->
<script>
jQuery(function() {
    var spanLen = jQuery('#product-options-wrapper input[type="radio"]').length;
    jQuery('#product-options-wrapper span').removeClass('checked');
    jQuery('#product-options-wrapper input[type="radio"]').removeAttr('checked');

    jQuery('#product-options-wrapper span').click(function(){
      var radioId = jQuery(this).attr('name');
      jQuery('#product-options-wrapper span').removeClass('checked') && jQuery(this).addClass('checked');
      jQuery('#product-options-wrapper input[type="radio"]').removeAttr('checked') && jQuery('#' + radioId).attr('checked', 'checked');
    });
});
</script>
<script>
    jQuery(function(){
        //开始定制按钮
        //暂时隐藏step1层 后期看是否是进行页面跳转
        jQuery(".step_1_Btn a").click(function(){
            jQuery(this).parents().find(".madeStep_1").css("display","none");
            jQuery(this).parents().find(".madeStep_2").css("display","block");
        });
        //点击P1按钮
        jQuery(".madeP_1_btn").click(function(){
            jQuery(this).addClass("madeP_btn_now");
            jQuery(this).siblings(".madeP_2_btn").removeClass("madeP_btn_now");
            jQuery(this).siblings(".madeBoxCons_p1").css("display","block");
            jQuery(this).siblings(".madeBoxCons_p2").css("display","none");
        });
        //点击P2按钮
        jQuery(".madeP_2_btn").click(function(){
            jQuery(this).addClass("madeP_btn_now");
            jQuery(this).siblings(".madeP_1_btn").removeClass("madeP_btn_now");
            jQuery(this).siblings(".madeBoxCons_p2").css("display","block");
            jQuery(this).siblings(".madeBoxCons_p1").css("display","none");
        });

        //定制图案或文字时 另一定制收起
        var _madeImgDt = jQuery(".madeKindImg");
        var _madeTexDt = jQuery(".madeKindTex");
        var _imgWrap = jQuery(".madeStepImg");
        var _texWrap = jQuery(".madeStepTex");

        //选择图案
        jQuery(".madeKindTitImg").click(function(){
            jQuery(this).addClass("madeNow");
            jQuery(this).siblings("dd").removeClass("madeNow");
            if(_madeTexDt.is(":visible")){
                jQuery(this).siblings(".madeKindImg").slideDown();
                jQuery(this).siblings(".madeKindTex").slideUp().removeClass("madeNow");
            }
            if(_madeImgDt.is(":hidden")){
                jQuery(this).siblings(".madeKindImg").slideDown()
            }
            //隐藏显示编辑
            jQuery(this).parents().find(".madeStepImg").css("display","block");
            jQuery(this).parents().find(".madeStepTex").css("display","none");
            jQuery(this).parents().find(".madeStepNone").css("display","none");
        });

        //选择文本
        jQuery(".madeKindTitTex").click(function(){
            jQuery(this).addClass("madeNow");
            jQuery(this).siblings("dd").removeClass("madeNow");
            if(_madeImgDt.is(":visible")){
                jQuery(this).siblings(".madeKindTex").slideDown();
                jQuery(this).siblings(".madeKindImg").slideUp().removeClass("madeNow");
            }
            if(_madeTexDt.is(":hidden")){
                jQuery(this).siblings(".madeKindTex").slideDown();
            }
            //隐藏显示编辑
            jQuery(this).parents().find(".madeStepTex").css("display","block");
            jQuery(this).parents().find(".madeStepImg").css("display","none");
            jQuery(this).parents().find(".madeStepNone").css("display","none");
        });
        //选择空白
        jQuery(".madeKindTitNon").click(function(){
            jQuery(this).addClass("madeNow");
            jQuery(this).siblings("dd").removeClass("madeNow");
            jQuery(this).siblings("dt").slideUp();

            //隐藏显示编辑
            jQuery(this).parents().find(".madeStepNone").css("display","block");
            jQuery(this).parents().find(".madeStepTex").css("display","none");
            jQuery(this).parents().find(".madeStepImg").css("display","none");
        });

        //设置字体
        jQuery(".setSize_20").click(function(){
            jQuery(this).parents().find(".madeTexWrap").attr("class","madeTexWrap size_40")
        });
        jQuery(".setSize_30").click(function(){
            jQuery(this).parents().find(".madeTexWrap").attr("class","madeTexWrap size_60")
        });
        jQuery(".setSize_40").click(function(){
            jQuery(this).parents().find(".madeTexWrap").attr("class","madeTexWrap size_80")
        });
    });
</script>
<!-- 选取图片 -->
<script type="text/javascript">
function previewImage(file,imgId){
  var _formBtn = document.getElementById('formBtn');
  var _gripImg = document.getElementById('img_grip');
  var _form = document.getElementById('imgFuns');
  if (file.files && file.files[0]){  
    var img = document.getElementById(imgId);  
    var reader = new FileReader();  
    reader.onload = function(evt){img.src = evt.target.result;}
    reader.readAsDataURL(file.files[0]);
    _form.style.opacity = 1;
    _gripImg.style.opacity = 1;
    _formBtn.style.display = "none";
  }else{
    file.select();
    var src = document.selection.createRange().text;
    jQuery("#"+imgId).attr("src",src);
  }
}
</script>

<!-- 图片处理 -->
<script language="javascript" type="text/javascript">
    var cut_div;  //裁减图片外框div
    var avatar;  //裁减图片
    var imgdefw;  //图片默认宽度
    var imgdefh;  //图片默认高度
    var offsetx = 82; //图片位置位移x
    var offsety = -193; //图片位置位移y
    var divx = 400; //外框宽度
    var divy = 400; //外框高度
    var cutx = 120;  //裁减宽度
    var cuty = 120;  //裁减高度
    var zoom = 1; //缩放比例

    var zmin = 0.1; //最小比例
    var zmax = 10; //最大比例
    var grip_pos = 5; //拖动块位置0-最左 10 最右
    var img_grip; //拖动块
    var img_track; //拖动条
    var grip_y; //拖动块y值
    var grip_minx; //拖动块x最小值
    var grip_maxx; //拖动块x最大值
    
    
//图片初始化
function imageinit(){
    cut_div = document.getElementById('cut_div');
    avatar = document.getElementById('avatar');
    imgdefw = avatar.width;
    imgdefh = avatar.height;
    if(imgdefw > divx){
        zoom = divx / imgdefw;
        avatar.width = divx;
        avatar.height = Math.round(imgdefh * zoom);
    }

    avatar.style.left = Math.round((divx - avatar.width) / 2);
    avatar.style.top = Math.round((divy - avatar.height) / 2) - divy;

    if(imgdefw > cutx){
        zmin = cutx / imgdefw;
    }else{
        zmin = 1;
    }
    zmax =  zmin > 0.25 ? 8.0: 4.0 / Math.sqrt(zmin);
    if(imgdefw > cutx){
        zmin = cutx / imgdefw;
        grip_pos = 5 * (Math.log(zoom * zmax) / Math.log(zmax));
    }else{
        zmin = 1;
        grip_pos = 5;
    }

    Drag.init(cut_div, avatar);
    avatar.onDrag = when_Drag;
}

//图片逐步缩放
function imageresize(flag){
    if(flag){
        zoom = zoom * 1.5;
    }else{
        zoom = zoom / 1.5;
    }
    if(zoom < zmin) zoom = zmin;
    if(zoom > zmax) zoom = zmax;
    avatar.width = Math.round(imgdefw * zoom);
    avatar.height = Math.round(imgdefh * zoom);
    checkcutpos();
    grip_pos = 5 * (Math.log(zoom * zmax) / Math.log(zmax));
    img_grip.style.left = (grip_minx + (grip_pos / 10 * (grip_maxx - grip_minx))) + "px";
}

//获得style里面定位
function getStylepos(e){
    return {x:parseInt(e.style.left), y:parseInt(e.style.top)}; 
}

//获得绝对定位
function getPosition(e){  
    var t=e.offsetTop;  
    var l=e.offsetLeft;  
    while(e=e.offsetParent){  
        t+=e.offsetTop;  
        l+=e.offsetLeft;  
    }
    return {x:l, y:t}; 
}

//检查图片位置
function checkcutpos(){
    var imgpos = getStylepos(avatar);
    
    max_x = Math.max(offsetx, offsetx + cutx - avatar.clientWidth);
    min_x = Math.min(offsetx + cutx - avatar.clientWidth, offsetx);
    if(imgpos.x > max_x) avatar.style.left = max_x + 'px';
    else if(imgpos.x < min_x) avatar.style.left = min_x + 'px';

    max_y = Math.max(offsety, offsety + cuty - avatar.clientHeight);
    min_y = Math.min(offsety + cuty - avatar.clientHeight, offsety);

    if(imgpos.y > max_y) avatar.style.top = max_y + 'px';
    else if(imgpos.y < min_y) avatar.style.top = min_y + 'px';
}

//图片拖动时触发
function when_Drag(clientX , clientY){
    checkcutpos();
}

//获得图片裁减位置
function getcutpos(){
    var imgpos = getStylepos(avatar);
    var x = offsetx - imgpos.x;
    var y = offsety - imgpos.y;
    var cut_pos = document.getElementById('cut_pos');
    cut_pos.value = x + ',' + y + ',' + avatar.width + ',' + avatar.height;
    return true;
}

//缩放条初始化
function gripinit(){
    img_grip = document.getElementById('img_grip');
    img_track = document.getElementById('img_track');
    track_pos = getPosition(img_track);

    grip_y = track_pos.y;
    grip_minx = track_pos.x + 4;
    grip_maxx = track_pos.x + img_track.clientWidth - img_grip.clientWidth - 5;

    // img_grip.style.left = (grip_minx + (grip_pos / 10 * (grip_maxx - grip_minx))) + "px";
    // img_grip.style.top = grip_y + "px";

    img_grip.style.left = (grip_minx + (grip_pos / 10 * (grip_maxx - grip_minx))) + "px";
    img_grip.style.top = grip_y - 115 + "px";

    Drag.init(img_grip, img_grip);
    img_grip.onDrag = grip_Drag;

}

//缩放条拖动时触发
function grip_Drag(clientX , clientY){
    var posx = clientX;
    img_grip.style.top = grip_y - 115 + "px";
    if(clientX < grip_minx){
        img_grip.style.left = grip_minx + "px";
        posx = grip_minx;
    }
    if(clientX > grip_maxx){
        img_grip.style.left = grip_maxx + "px";
        posx = grip_maxx;
    }

    grip_pos = (posx - grip_minx) * 10 / (grip_maxx - grip_minx);
    zoom = Math.pow(zmax, grip_pos / 5) / zmax;
    if(zoom < zmin) zoom = zmin;
    if(zoom > zmax) zoom = zmax;
    avatar.width = Math.round(imgdefw * zoom);
    avatar.height = Math.round(imgdefh * zoom);
    checkcutpos();
}

//页面载入初始化
function avatarinit(){
    imageinit();
    gripinit();
}

if (document.all){
    window.attachEvent('onload',avatarinit);
}else{
    window.addEventListener('load',avatarinit,false);
} 
</script>

<!-- 图片旋转 -->
<script type="text/javascript">
jQuery(document).ready(function (){
    function adjust(el, selection) {
        var scaleX = jQuery(el).width() / (selection.width || 1);
        var scaleY = jQuery(el).height() / (selection.width || 1);
        jQuery(el+' img').css({
            width: Math.round(scaleX*jQuery('#avatar').width() ) + 'px',
            height: Math.round(scaleY*jQuery('#avatar').height() ) + 'px',
            marginLeft: '-' + Math.round(scaleX * selection.x1) + 'px',
            marginTop: '-' + Math.round(scaleY * selection.y1) + 'px'
        });
    }
}); 

var value = 0;
function avatarrotateleft(){
    value -=90;
    jQuery('#avatar').rotate({ animateTo:value});
}
function avatarrotateright(){
    value +=90;
    jQuery('#avatar').rotate({ animateTo:value});
}
</script>
<?php else: 
?>
<div class="product-view">
    <div class="product-essential">
        <form action="<?php echo $this->getSubmitUrl($_product) ?>" method="post" id="product_addtocart_form"<?php if($_product->getOptions()): ?> enctype="multipart/form-data"<?php endif; ?>>
            <?php echo $this->getBlockHtml('formkey') ?>
            <div class="no-display">
                <input type="hidden" name="product" value="<?php echo $_product->getId() ?>" />
                <input type="hidden" name="related_product" id="related-products-field" value="" />
            </div>

            <div class="product-shop">
                <div class="product-name">
                    <h1><?php echo $_helper->productAttribute($_product, $_product->getName(), 'name').$shortDescription ?></h1>
                </div>
                <?php echo $this->getChildHtml('alert_urls') ?>
                <!--            --><?php //echo $this->getChildHtml('product_type_data') ?>
                <?php echo $this->getTierPriceHtml() ?>
                <?php echo $this->getChildHtml('extrahint') ?>

                <?php if (!$this->hasOptions()):?>
                    <div class="add-to-box">
                        <?php if($_product->isSaleable()): ?>
                            <?php echo $this->getChildHtml('addtocart') ?>
                            <?php if( $this->helper('wishlist')->isAllow() || $_compareUrl=$this->helper('catalog/product_compare')->getAddUrl($_product)): ?>
                                <span class="or"><?php echo $this->__('OR') ?></span>
                            <?php endif; ?>
                        <?php endif; ?>
                        <?php echo $this->getChildHtml('addto') ?>
                    </div>
                    <?php echo $this->getChildHtml('extra_buttons') ?>
                <?php elseif (!$_product->isSaleable()): ?>
                    <div class="add-to-box">
                        <?php echo $this->getChildHtml('addto') ?>
                    </div>
                <?php endif; ?>

                <?php echo $this->getChildHtml('other');?>

                <?php if ($_product->isSaleable() && $this->hasOptions()):?>
                    <?php echo $this->getChildChildHtml('container1', '', true, true) ?>
                <?php endif;?>
                <?php if ($_product->isSaleable() && $this->hasOptions()):?>
                    <?php echo $this->getChildChildHtml('container2', '', true, true) ?>
                <?php endif;?>
                <div class="short-description">
                    <img alt="" src="<?php echo $this->getSkinUrl("images/productDetail_des.png") ?>">
                </div>
            </div>

            <div class="product-img-box">
                <?php echo $this->getChildHtml('media') ?>
            </div>

            <div class="clear"></div>

        </form>
        <script type="text/javascript">
            //<![CDATA[
            var productAddToCartForm = new VarienForm('product_addtocart_form');
            productAddToCartForm.submit = function(button, url) {

                if (this.validator.validate()) {
                    var form = this.form;
                    var oldUrl = form.action;
                    var list= jQuery('input:radio[data-input="kinds"]:checked').val();
                    if(list==null){
                        alert("请选择尺码");
                        return false;
                    }

                    if (url) {
                        form.action = url;
                    }
                    var e = null;
                    try {
                        this.form.submit();
                    } catch (e) {
                    }
                    this.form.action = oldUrl;
                    if (e) {
                        throw e;
                    }

                    if (button && button != 'undefined') {
                        button.disabled = true;
                    }
                }
            }.bind(productAddToCartForm);

            productAddToCartForm.submitLight = function(button, url){
                if(this.validator) {
                    var nv = Validation.methods;
                    delete Validation.methods['required-entry'];
                    delete Validation.methods['validate-one-required'];
                    delete Validation.methods['validate-one-required-by-name'];
                    // Remove custom datetime validators
                    for (var methodName in Validation.methods) {
                        if (methodName.match(/^validate-datetime-.*/i)) {
                            delete Validation.methods[methodName];
                        }
                    }

                    if (this.validator.validate()) {
                        if (url) {
                            this.form.action = url;
                        }
                        this.form.submit();
                    }
                    Object.extend(Validation.methods, nv);
                }
            }.bind(productAddToCartForm);
            //]]>
        </script>
    </div>






    <!-- 产品参数 -->
    <div class="productArgs">
        <div class="productArgs_tit">产品参数</div>
        <div class="productArgs_box">
            <ul class="clearfix">
                <li>货号：<?php echo $product_sku;?></li>
                <li>篮球规格: <?php echo $product_norm;?></li>
                <li>系列：<?php echo $product_catena;?></li>
                <li>场地：<?php echo $product_side;?></li>
                <li>材质：<?php echo $product_material;?></li>
            </ul>
        </div>
    </div>
    <!-- 产品详情 -->
    <style>
        .product-collateral-box-img img{
            margin: 0 0 0 -60px;
        }
    </style>
    <div class="product-collateral">
        <div class="productDetail_collTit">
            <img src='<?php echo $this->getSkinUrl("images/productDetail_collateralTit.png") ?>' alt="">
        </div>
        <?php
        $urlkey = $_product->getUrlKey();
        $sku = $_product->getSku();
        $i = 0;
        $arr = array( "正面/FRONT","反面/BACK","侧面/SIDE");
        //----------------------------------------------------------------------------STA
        $imgCount = $_product->getImageCount();
        for($count = 0;$count <$imgCount;$count++){
            //----------------------------------------------------------------------------END
            $des = $arr[$i];
            $i++;
            ?>
            <div class="product-collateral-wrap">
                <div class="product-collateral-box">
                    <h2 class="product-collateral-box-nam"><?php echo $des; ?></h2>
                    <?php if($count == 0 && $sku == '74-582y'): ?>
                        <div class="product-collateral-box-img">
                            <img src="<?php echo Mage::getModel('core/variable')->loadByCode('static_image_domain')->getValue('html') ?>/media/catalog/product/74-582y/74-582-top1.jpg" alt=""/>
                        </div>
                    <?php endif; ?>
                    <div class="product-collateral-box-img">
                        <img src="<?php echo Mage::getModel('core/variable')->loadByCode('static_image_domain')->getValue('html') ?>/media/catalog/product/<?php echo $sku."/". $urlkey."-".($i+10) ?>.jpg" alt=""/>
                    </div>
                </div>
            </div>

        <?php
        }
        ?>
        <?php
        if(($size_table_id != null)){
            $size_table_url = Mage::getModel('core/variable')->loadByCode('aliyun_skin_images')->getValue('html') ."images/sizeTable/".$size_table_id.".png";
            ?>
            <center><img src='<?php echo $size_table_url; ?>' alt=""></center>
        <?php
        }
        ?>
        <?php
        if(($product_attributeSetName != null) && $product_attributeSetName == 72){
            $view_bottom_url =  Mage::getModel('core/variable')->loadByCode('aliyun_skin_images')->getValue('html') ."images/sizeTable/view_bottom.png";
            ?>
            <center><img src='<?php echo $view_bottom_url ?>' alt=""></center>
        <?php
        }
        ?>
    </div>
    <!-- 产品详情 e -->
    <?php echo $this->getChildHtml('upsell_products') ?>
</div>
<?php
endif;
?>